version: "3"
networks:
  custom:

services:
  web:
    container_name: web
    build:
      context: ./services/web
      # `args` is used to make environment variables visible during the build. See https://docs.docker.com/compose/compose-file/compose-file-v3/#environment.
      args:
        - CONTROLLER_SERVER_URL=http://localhost:5001
        - STATS_SERVER_URL=http://localhost:5002
    ports:
      - 8080:80
    networks:
      - custom

  controller_server:
    container_name: controller
    build: ./services/controller_server
    ports:
      - 5001:5001
    networks:
      - custom
    environment:
      - STATS_SERVER_URL=http://stats:5002
      - GAME_SERVER_URL=http://game:4000
  game_server:
    container_name: game
    build: ./services/game_server
    ports:
      - 4000:4000
    networks:
      - custom

  stats_server:
    container_name: stats
    build: ./services/stats_server
    ports:
      - 5002:5002
    networks:
      - custom
